var doc_campanias_view = Backbone.View.extend({
    el: 'body',
    defaults: {
        content_page: "#content_page"
    },
    events:{
        "click .btnGuardarCampana":"f_nueva_campaña",
        "click .btnGuardarCuestionario":"f_nuevoCuestionario",
        "click .btnDeleteCuestionario":"f_deleteCuestionario"

    },
    initialize: function(e){
        try {
            $("#tablaCuestionarios").DataTable();
        }catch(exception){
            console.log(exception);
        }
    },
    f_nueva_campaña:function(e){
        var _this = this;

        elementos = ['txt_campana','txt_descripcion'];

        la_data = {
            cliente:        $("#txt_cliente").val(),
            campana:        $("#txt_campana").val(),
            descripcion:    $("#txt_descripcion").val()
        }

        if(la_data.campana != "" || la_data.descripcion != ""){

            _this.model.f_guardar_documento_campana(la_data).done( function(response){
                console.log(response);
                if(response.ok){
                    swal("Bien!","Nueva campaña agregada correctamente","success");
                    location.href = BASE_URL+'admon-clientes/campana-documentos';
                }else{
                    swal("!!Alerta!!","No fue posible agregar una nueva campaña","error");
                }
            });

        }else{
            elementos.forEach(item=>{
                swal("Alerta","Llena todos los campos pintados de color rojo ","warning");
                if($("#"+item).val() == ""){
                    $("#"+item).css({'border-left-width':'10px','border-left-color':'red'});
                }
            });
        }

    },
    f_nuevoCuestionario:function(e){
        var _this = this;
        la_data = {
            cliente:        $(".txtCliente").val(),
            cuestionario:   $(".txtCuestionario").val(),
            descripcion:    $(".txtDescripcion").val(),
            intentos:       $(".txtIntentos").val(),
            tipo:           $(".txtTipo").val()        
        }

        if( la_data.cuestionario != "" && la_data.descripcion != ""){
            _this.model.f_nuevoCuestionario(la_data).done( function(response){
                console.log(response);
                if(response.ok){
                    swal("Bien!","Nuevo cuastonario agregado correctamente","success");
                    location.href = BASE_URL+'catalogo-general/tipo-cuestionario';
                }else{
                    swal("Upss!","No fue posible, agregar un nuevo cuestionario","error");
                }
            });
        }else{
            $(".txtCuestionario").css({"border-left-width":"10px","border-left-color":"#ea6a6a"});
            $(".txtDescripcion").css({"border-left-width":"10px","border-left-color":"#ea6a6a"});
            swal("Upss!","Debes rellenar todos los campos","error");
        }

    },
    f_deleteCuestionario:function(e){
        var _this = this;
        lo_current = e.currentTarget;

        var id_cuestionario = parseInt($(lo_current).data('hash'));

        swal({   
            title: "¿Esta seguro?",   
            text: "Que desea, elimnar este cuestionario !!",   
            type: "warning",   
            showCancelButton: true,   
            confirmButtonColor: "#DD6B55",   
            confirmButtonText: "Confirmar",   
            closeOnConfirm: false 
        }, function(response){ 
            console.log(response);
            if(response){

                _this.model.f_eliminarCuestionario(id_cuestionario).done(function(res){
                });
                location.href = BASE_URL+'catalogo-general/tipo-cuestionario';

            }else{
                swal("Cancelado correctamente");
            }

        });
    }

});

$(document).ready(function () {
    doc_campanias_view = new doc_campanias_view({model: new doc_campanias_model()});
    
});