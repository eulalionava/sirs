var Sistema_view = Backbone.View.extend({
    el: 'body',
    defaults: {
        content_page: "#content_page"
    }
    ,events:{
        "click .notifi-title":"f_verNotificaciones"
    },
    initialize: function(e){
        try {
            
        }catch(exception){
            console.log(exception);
        }
    },
    f_notificaciones:function(e){
        var _this = this;
        var id_tipo_persona = $("#tipoPersona").val();
        if(id_tipo_persona == 1){

            _this.model.f_notificacionHorarios().done(function(response){
                console.log(response);
                if(! response.ok){
                    $(".notificaciones li a span").text(1);
                    $(".modal-body p").text(response.mensaje);
                }
            });

        }
    },
    f_verNotificaciones:function(){
        $(".modal").modal("show");
        $("#tipoPersona").val(0);
    },
    f_abrirAplicativo: function(e){
        e.preventDefault();        
        var _this = this;
        lo_currentItem = e.currentTarget;
        ls_href = BASE_URL+$(lo_currentItem).attr("href");
        ls_title = $(lo_currentItem).text().trim()+' - SIRS::.. Grupo NACH';        
        history.pushState(null, ls_title, ls_href);        
        var la_dataCollection = {
            to_url: ls_href
        };
        
        _this.model.f_abrirAplicativoModel(la_dataCollection).done(function (response){
            if(response.return < 0){
                swal("¡Error!", "Ocurrió un error inesperado, favor de contactar a sistemas.", "error");
                return -1;
            }
            $("title").html(ls_title);
            $(_this.defaults.content_page).html(response.contenido);
        });
        
        return 1;
    },
    f_iniciarSesion: function(e){
        var _this = this;
        var la_dataCollection = {};
        ls_usuario = $(_this.defaults.usuario).val();
        if(ls_usuario.length == 0){
            swal("¡Atención!", "Ingrese su usuario para continuar.", "warning");
            return -1;
        }
        
        ls_password = $(_this.defaults.password).val();
        if(ls_password.length == 0){
            swal("¡Atención!", "Ingrese su contraseña para continuar.", "warning");
            return -1;
        }

        la_dataCollection = {
            usuario: ls_usuario,
            password: ls_password
        }

        _this.model.f_iniciarSesionModel(la_dataCollection).done(function (response){
            if(response.return < 0){
                swal("¡Error!", "Ocurrió un error inesperado, favor de contactar a sistemas.", "error");
                return -1;
            }

            if(response.login){
                location.href = 'panel-principal';
            }else{
                swal("¡Atención!", response.mensaje, "error");
                return -1;
            }
        });
        
        return 1;
    }
});

$(document).ready(function () {
    Sistema_view = new Sistema_view({model: new Sistema_model()});
    
    
    
});
